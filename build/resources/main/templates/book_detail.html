<!--<link rel="stylesheet" type="text/css" th:href="@{/bootstrap.min.css}">-->
<html layout:decorate="~{layout}">
<div layout:fragment="content" class="container my-3">

    <div class="my-3"></div>

    <div class="my-3 d-flex justify-content-center">
        <h2 class="text-light" th:text="${book.subject}"></h2>
    </div>

    <div class="my-3 d-flex justify-content-center text-light">
        <ul>
            <li th:text="'저자: ' + ${book.author}"></li>
            <li th:text="'책내용: ' + ${book.content}"></li>
        </ul>
    </div>

    <div class="my-3"></div>
    <!-- 별접 입력 -->
    <div class="d-flex justify-content-center">
        <h5 class="text-light" th:text="|별점을 선택해주세요|"></h5>
    </div>

    <div class="d-flex justify-content-center" style="white-space: pre-line;">
        <form th:action="@{|/ibookleague/book/rate/create/${book.id}|}" method="post" id="rateForm">

            <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                <input type="radio" class="btn-check" name="rate" id="rate1" value="1" autocomplete="off">
                <label class="btn btn-outline-primary" for="rate1">1</label>

                <input type="radio" class="btn-check" name="rate" id="rate2" value="2" autocomplete="off">
                <label class="btn btn-outline-primary" for="rate2">2</label>

                <input type="radio" class="btn-check" name="rate" id="rate3" value="3" autocomplete="off">
                <label class="btn btn-outline-primary" for="rate3">3</label>

                <input type="radio" class="btn-check" name="rate" id="rate4" value="4" autocomplete="off">
                <label class="btn btn-outline-primary" for="rate4">4</label>

                <input type="radio" class="btn-check" name="rate" id="rate5" value="5" autocomplete="off">
                <label class="btn btn-outline-primary" for="rate5">5</label>

            </div>

            <div class="d-flex justify-content-center">

                <input type="submit" value="별점등록" class="btn btn-primary my-2">
            </div>
        </form>
    </div>



    <!-- 별점 갯수 표시 -->
    <h5 class="border-bottom my-3 py-2 text-light" th:text="|${#lists.size(book.rateList)}개의 별점이 있습니다.|"></h5>
    <div class="my-3" th:each="rate : ${book.rateList}">
        <ul>
            <li class="text-light" th:text="${rate.rate}"></li>
        </ul>
    </div>

    <!-- 리뷰 갯수 표시 -->
    <h5 class="border-bottom my-3 py-2 text-light" th:text="|${#lists.size(book.reviewList)}개의 리뷰가 있습니다.|"></h5>
    <div class="card my-3 bg-secondary" th:each="review : ${book.reviewList}">
        <div class="card-body">
            <div class="card-text text-dark" style="white-space: pre-line;" th:text="${review.content}"></div>
        </div>
    </div>

    <!-- 리뷰 입력 -->
    <form th:action="@{|/ibookleague/review/create/${book.id}|}" method="post">
        <textarea name="content" id="content" rows="15" class="form-control bg-secondary"></textarea>
        <div class="d-flex justify-content-center">
            <input type="submit" value="리뷰등록" class="btn btn-primary my-2">
        </div>

    </form>

</div>

<!-- 경고 메시지 표시 부분 -->
<script layout:fragment="script" type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // 경고 메시지를 서버에서 받아옴
        var warningMessage = '!!!같은 사용자는 한 번만 평점을 입력할 수 있습니다!!!';
        var form = document.getElementById('rateForm')

        // warningMessage가 비어있지 않다면 JavaScript 이벤트 리스너를 추가
        if (warningMessage && form) {
            // 경고 메시지 표시
            form.addEventListener('submit', function ()
                {
                    alert(warningMessage);
                });
        }
    });
</script>


<!--<script layout:fragment="script" type="text/javascript">-->
<!--    const warninig_elements = document.getElementsByClassName("warningMessage");-->
<!--    Array.from(warninig_elements).forEach(function(element) {-->
<!--        element.addEventListener('click', function() {-->
<!--            if (confirm("평점은 두번 입력할 수 없습니다.")) {-->
<!--                // 확인 버튼을 누르면 해당 book id의 detail 페이지 즉, 이 html로 되돌아간다.-->
<!--                location.href = "@{|/ibookleague/book/detail/${book.id}|}";-->
<!--            }-->
<!--            ;-->
<!--        });-->
<!--    });-->
<!--</script>-->
</html>
